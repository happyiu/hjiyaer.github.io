{"meta":{"title":"å’¦~è¢«ä½ å‘ç°å’¯","subtitle":"å˜»å˜»","description":"æ„¿ä½ å‡ºèµ°åŠç”Ÿä»æ˜¯å°‘å¹´","author":"ERYORE","url":"http://blog.hjiya.cn"},"pages":[{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"client/index.html","permalink":"http://blog.hjiya.cn/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"about","date":"2020-03-20T14:14:36.000Z","updated":"2020-03-20T08:55:49.153Z","comments":false,"path":"about/index.html","permalink":"http://blog.hjiya.cn/about/index.html","excerpt":"","text":"[çŒ«ã«ãªã‚ŠãŸã„ã®æ˜æ˜å°±] ä¸&nbsp; æ˜æ˜å°±&nbsp; ï¼ˆ çœŸï¼ˆã¾ï¼‰ç™½ï¼ˆã—ã‚ï¼‰ ï¼‰ å¯¹è¯ä¸­... bot_ui_ini()","keywords":"å…³äº"},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2020-03-20T03:19:20.169Z","comments":true,"path":"comment/index.html","permalink":"http://blog.hjiya.cn/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"donate/index.html","permalink":"http://blog.hjiya.cn/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2020-03-20T08:51:25.813Z","comments":false,"path":"lab/index.html","permalink":"http://blog.hjiya.cn/lab/index.html","excerpt":"","text":"sakuraä¸»é¢˜æš‚æœªå¼€æ”¾","keywords":"Labå®éªŒå®¤"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2020-03-20T05:45:36.428Z","comments":false,"path":"music/index.html","permalink":"http://blog.hjiya.cn/music/index.html","excerpt":"","text":"æˆ‘çš„å–œæ¬¢å…ˆåˆ«è¯´ä¸å–œæ¬¢å˜›ï¼Œå¬å¤šäº†ä¹Ÿå°±ä¹ æƒ¯äº†é¸­","keywords":"å–œæ¬¢çš„éŸ³ä¹"},{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"bangumi/index.html","permalink":"http://blog.hjiya.cn/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2020-03-20T03:58:51.531Z","comments":true,"path":"links/index.html","permalink":"http://blog.hjiya.cn/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"rss/index.html","permalink":"http://blog.hjiya.cn/rss/index.html","excerpt":"","text":""},{"title":"æ‚¦è¯»2","date":"2018-12-12T14:14:16.000Z","updated":"2020-03-20T09:09:13.433Z","comments":true,"path":"tags/index.html","permalink":"http://blog.hjiya.cn/tags/index.html","excerpt":"","text":""},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"video/index.html","permalink":"http://blog.hjiya.cn/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"theme-sakura/index.html","permalink":"http://blog.hjiya.cn/theme-sakura/index.html","excerpt":"","text":"Hexoä¸»é¢˜Sakuraä¿®æ”¹è‡ªWordPressä¸»é¢˜Sakuraï¼Œæ„Ÿè°¢åŸä½œè€…Mashiro","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"}],"posts":[{"title":"å¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘","slug":"wxxcxcloud","date":"2020-03-30T03:31:18.000Z","updated":"2020-03-30T03:33:52.875Z","comments":true,"path":"2020/03/30/wxxcxcloud/","link":"","permalink":"http://blog.hjiya.cn/2020/03/30/wxxcxcloud/","excerpt":"","text":"å¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘ä»€ä¹ˆæ˜¯å¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘ï¼Ÿå¾®ä¿¡å°ç¨‹åº + äº‘ï¼ˆäº‘å‡½æ•°ï¼ˆç›¸å½“äºä¸€ä¸ªåç«¯æœåŠ¡ï¼‰+ äº‘æ•°æ®åº“ï¼‰å¼€å‘â€¦ å¥½å§ï¼Œé‡ç‚¹å°±åœ¨è¿™ä¸ªäº‘å¼€å‘ä¸Šå•¦ï¼Œå®ƒå¼±åŒ–äº†åç«¯å’Œè¿ç»´æ¦‚å¿µï¼Œæ— éœ€æ­å»ºæœåŠ¡å™¨ï¼Œä½¿ç”¨å¾®ä¿¡æä¾›çš„äº‘æœåŠ¡å°±èƒ½å®Œæˆåç«¯å’Œè¿ç»´çš„æ­å»ºã€‚ ç›®å½•ç»“æ„é¦–å…ˆæ¥ç…ç…å¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘é¡¹ç›®çš„å¤§è‡´ç›®å½•ç»“æ„å§ . â”œâ”€â”€ cloudfunctions // äº‘å‡½æ•°æ–‡ä»¶ç›®å½• â”œâ”€â”€ book // è¿™é‡Œå°±æ”¾ç½®ä¸€äº›äº‘å‡½æ•°é¡¹ç›®â”œâ”€â”€ miniprogram // è¿™ä¸ªæ–‡ä»¶å¤¹é‡Œå­˜æ”¾çš„å°±æ˜¯æ­£å¸¸çš„å°ç¨‹åºé¡¹ç›®äº†â”œâ”€â”€ project.config.json // é¡¹ç›®çš„é…ç½®æ–‡ä»¶ éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šproject.config.json ç‰¹æ®Šçš„é…ç½® { // è¿™é‡Œå®šä¹‰çš„å¯¹åº”ä¸Šé¢çš„ç›®å½•åç§° &quot;cloudfunctionRoot&quot;: &quot;cloudfunctions/&quot;, &quot;miniprogramRoot&quot;: &quot;miniprogram/&quot;, } é¡¹ç›®ç»“æ„å¹¶ä¸å¤æ‚ï¼Œå°±æ˜¯å°†ä¼ ç»Ÿçš„å°ç¨‹åºé¡¹ç›®æ”¾å…¥miniprogram è¿™ä¸ªå•ç‹¬çš„æ–‡ä»¶å¤¹ä¸­ï¼Œå†åˆ›å»ºå¦å¤–çš„ä¸€ä¸ªæ–‡ä»¶å¤¹æ¥å­˜æ”¾äº‘å‡½æ•°ã€‚ é‚£ä¹ˆæ¥ä¸‹æ¥å°±æ¥å®ç°ä¸€ä¸ªç®€å•çš„å°ç¨‹åºçš„äº‘å¼€å‘å§ å®è·µè¿™é‡Œå‘¢æˆ‘ä»¬å°±å®Œæˆä¸€ä¸ªç®€å•çš„å°ç¨‹åºå§ï¼Œè¿™ä¸ªå°ç¨‹åºå‘¢å°±åªæœ‰ä¸€ä¸ªé¡µé¢ï¼ˆç®€å•å§ï¼Œå“ˆå“ˆå“ˆå“ˆï¼‰ ä¸»è¦æ¶‰åŠçš„åŠŸèƒ½æœ‰ï¼š è°ƒç”¨æ‰‹æœºæ‘„åƒå¤´ï¼Œæ‰«æå›¾ä¹¦æ¡å½¢ç  ç„¶åä»è±†ç“£ä¸Šé€šè¿‡çˆ¬è™«è·å–åˆ°å›¾ä¹¦ä¿¡æ¯ å°†å›¾ä¹¦ä¿¡æ¯å­˜å…¥æ•°æ®åº“ é¡µé¢å†ä»æ•°æ®åº“ä¸­è¯»å–æ¸²æŸ“å‡ºæ¥ ç„¶åå°±å†åšä¸ªåˆ†é¡µçš„åŠŸèƒ½å§ï¼Œä¸Šæ‹‰è§¦åº•ååŠ è½½ä¸‹ä¸€é¡µ å°±è¿™äº›åŠŸèƒ½ï¼Œè¶…ç®€é™‹çš„demoï¼Œä½†éº»é›€è™½å°äº”è„ä¿±å…¨ã€‚ ä¸‹é¢ç›´å¥”ä¸»é¢˜ å°ç¨‹åºé¡µé¢å¸ƒå±€é¡µé¢å¸ƒå±€çš„è¯ï¼Œæ€ä¹ˆç®€å•æ€ä¹ˆæ¥å¥½å§â€¦ lookå…ˆå°±è¿™æ ·ç®€å•çš„å¸ƒå±€ä¸‹å§ æ¥ä¸‹æ¥å†æ¥çœ‹çœ‹jséƒ¨åˆ† é€»è¾‘ç¼–å†™ é‚£é¦–å…ˆæˆ‘ä»¬å…ˆæ¥åˆ›å»ºæ•°æ®åº“ï¼Œç„¶åæ¸²æŸ“å‡ºæ•°æ®å§ åˆ›å»ºæ•°æ®åº“çš„æ­¥éª¤åœ¨ å¾®ä¿¡å¼€å‘è€…å·¥å…·â€”äº‘å¼€å‘â€”æ•°æ®åº“ä¸­åˆ›å»ºå³å¯ è¦ä½¿ç”¨æ•°æ®åº“é‡Œçš„æ•°æ®é¦–å…ˆè¦åˆå§‹åŒ–ï¼Œå¦‚ä¸‹ // home.js // åˆå§‹åŒ–æ•°æ®åº“ let db = wx.cloud.database() Page({ /** * é¡µé¢çš„åˆå§‹æ•°æ® */ data: { books: [], page: 0, }, /** * ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½ */ onLoad: function (options) { this.getBooksList() // å°†è¯»å–æ•°æ®çš„æ–¹æ³•å°è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œæ–¹ä¾¿å¤ç”¨ }, getBooksList(){ // è¯»å–æ•°æ®åº“ï¼Œå¹¶å°†æ•°æ®å­˜å…¥data const limit = 3 // åˆ†é¡µæ“ä½œï¼Œè¡¨ç¤ºä¸€é¡µæ˜¾ç¤ºå‡ æ¡æ•°æ® wx.showLoading() db.collection(&#39;books&#39;) // è¡¨ç¤ºè¦ç”¨å“ªå¼ è¡¨ .orderBy(&#39;create_time&#39;, &#39;desc&#39;) // ç®€å•çš„æ’åº .skip(this.data.page*limit) // è·³è¿‡å‰né¡µ .limit(limit) // æ¯æ¬¡æ‹¿å–næ¡ .get({ // æŸ¥è¯¢ success: res =&gt; { // console.log(res) if(res.data.length == 0){ this.setData({ isBottom: true }) } let newBooks = res.data.map(v =&gt; { // ç®€å•çš„å°†æŸ¥è¯¢ç»“æœåšä¸ªå¤„ç† const rate = Math.round(v.rate / 2) v.rateDisplay = &quot;â˜…â˜…â˜…â˜…â˜…â˜†â˜†â˜†â˜†â˜†&quot;.slice(5 - rate, 10- rate) return v }) if (this.data.page == 0) { // å¦‚æœæ˜¯ç¬¬ä¸€é¡µå°±æ‹‰å–ç¬¬ä¸€é¡µçš„æ•°æ® this.setData({ books: newBooks }) } else { this.setData({ // å› ä¸ºè¦æœ‰åˆ†é¡µæ•ˆæœï¼Œæ‰€ä»¥è¿™é‡Œè¦æŠŠæ–°æ•°æ®æ‹¼æ¥ä¸Šè€æ•°æ® books: [...this.data.books, ...newBooks] }) } wx.hideLoading() } }) }, é‚£ä¹ˆè¿™æ ·å°±å®Œæˆäº†ä»æ•°æ®åº“æ‹¿å–æ•°æ®å•¦ å…¶æ¬¡æˆ‘ä»¬æƒ³ç‚¹å‡»è°ƒå‡ºæ‘„åƒå¤´ï¼Œè§£ææ¡å½¢ç ï¼Œç„¶åè°ƒç”¨äº‘å‡½æ•°å»çˆ¬å–è±†ç“£è¯»ä¹¦çš„æ•°æ® // home.wxml // ç»™ button ç»‘å®šä¸€ä¸ªäº‹ä»¶å§ &lt;button class=&quot;btn&quot; type=&quot;primary&quot; bindtap=&quot;scanQR&quot;&gt;æ‰«ä¹¦&lt;/button&gt; // home.js // åˆå§‹åŒ–æ•°æ® let db = wx.cloud.database() Page({ /** * é¡µé¢çš„åˆå§‹æ•°æ® */ data: { books: [] }, // ç‚¹å‡»æ‰«ä¹¦è§¦å‘çš„äº‹ä»¶ scanQR(){ wx.scanCode({ success: res =&gt; { // console.log(res.result) wx.showLoading() wx.cloud.callFunction({ // callè°ƒç”¨äº‘å‡½æ•° â€”â€”â€”â€”&gt; å¯çœ‹ä¸‹ä¸€éƒ¨åˆ†ä»£ç  name: &#39;bookfn&#39;, // è¿™é‡Œè¦è§¦å‘å“ªä¸ªäº‘å‡½æ•° data: { // ä¼ å‚ isbn: res.result, }, success: ({result}) =&gt; { // æˆåŠŸçš„å›è°ƒ // console.log(result) result.create_time = new Date().getTime() // æ·»åŠ ä¸€ä¸ªæ‰«ä¹¦æ—¶é—´ // å°†çˆ¬å–è±†ç“£çš„ä¿¡æ¯å­˜å…¥æ•°æ®åº“ db.collection(&#39;books&#39;).add({ data: result, success: ret =&gt; { wx.hideLoading() if(ret._id){ wx.showModal({ title: &#39;æç¤ºä¿¡æ¯&#39;, content: `ã€Š${result.title}ã€‹æ·»åŠ æ·»åŠ æˆåŠŸ` }) this.getBooksList() } } }) } }) } }) }, ä¸Šé¢å°±æ˜¯ç‚¹å‡»æ‰«ä¹¦çš„é€»è¾‘å•¦ï¼Œç„¶åé‡ç‚¹æ˜¯è°ƒç”¨äº†ä¸‹é¢çš„äº‘å‡½æ•° // cloudfunctions/bookfn/index.js // äº‘å‡½æ•°å…¥å£æ–‡ä»¶ const cloud = require(&#39;wx-server-sdk&#39;) const axios = require(&#39;axios&#39;) const doubanbook = require(&#39;doubanbook&#39;) const cheerio = require(&#39;cheerio&#39;) cloud.init() async function getDoubanBool(isbn) { // è¿™æ˜¯è±†ç“£urlè§„åˆ™ let url = &#39;https://search.douban.com/book/subject_search?search_text=&#39; + isbn // è¯·æ±‚è±†ç“£æ•°æ® let res = await axios.get(url) // åˆ›å»ºæ­£åˆ™ ç”¨æ¥åŒ¹é… åŠ å¯†çš„å›¾ä¹¦ä¿¡æ¯ let reg = /window\\.__DATA__ = &quot;(.*)&quot;/ // æ­£åˆ™åŒ¹é…åŠ å¯†çš„å­—ç¬¦ä¸² if(reg.test(res.data)){ // è§£å¯† let searchData = doubanbook(RegExp.$1)[0] return searchData } } // getDoubanBool(9787121349126) // äº‘å‡½æ•°å…¥å£å‡½æ•° exports.main = async (event, context) =&gt; { let { isbn } = event let bookInfo = await getDoubanBool(isbn) // è·å–bookçš„è¯¦æƒ…é¡µ let detailPage = await axios.get(bookInfo.url) // è§£æé¡µé¢æ¥è·å–æŒ‡å®šçš„å†…å®¹ let $ = cheerio.load(detailPage.data) const summary = $(&quot;#link-report .intro&quot;).text() return { bid: bookInfo.id, title: bookInfo.title, rate: bookInfo.rating.value, image: bookInfo.cover_url, summary } } ç„¶åæˆ‘ä»¬æœ€åå†å¤„ç†ä¸‹è§¦åº•åˆ·æ–°å§ onReachBottom: function () { this.setData({ page: this.data.page + 1 // å°†å½“å‰é¡µæ•°åŠ 1 }) this.getBooksList() // ä»æ•°æ®åº“æ‹‰å–æ–°æ•°æ® }, è‡³æ­¤ï¼Œæ‰«ä¹¦çš„å°Demoå°±å®Œæˆå•¦ï¼Œç„¶åæˆ‘ä»¬å†æŒ‰å–œå¥½æ”¹æ”¹é¡µé¢å°±okäº†ï¼Œå°±è®©æˆ‘ä»¬çœ‹çœ‹æ•ˆæœå›¾å§","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"http://blog.hjiya.cn/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"http://blog.hjiya.cn/categories/æŠ€æœ¯/"}]},{"title":"UmiJs","slug":"umi","date":"2020-03-28T12:01:48.000Z","updated":"2020-03-28T12:16:10.002Z","comments":true,"path":"2020/03/28/umi/","link":"","permalink":"http://blog.hjiya.cn/2020/03/28/umi/","excerpt":"","text":"Umiå®‰è£… å…¨å±€å®‰è£… Umi æ¨èä½¿ç”¨ yarn ä»£æ›¿ npm æ¥å®‰è£… umi ï¼Œ yarn ä¼šé’ˆå¯¹éƒ¨åˆ†åœºæ™¯åšä¸€äº›ç¼“å­˜ä»¥èŠ‚çœæ—¶é—´ï¼Œä½ å¯ä»¥è¾“å…¥ä»¥ä¸‹å‘½ä»¤æ¥å…¨å±€å®‰è£… yarnï¼Œä½¿ç”¨yarnåé¡¹ç›®ä¸­å°½é‡é¿å…å†ä½¿ç”¨npmï¼Œä¸ç„¶å¯èƒ½ä¼šå‘ç”Ÿæ„æƒ³ä¸åˆ°çš„é”™è¯¯ã€‚ # ä½¿ç”¨ yarn å®‰è£… Umi yarn global add umi # æŸ¥çœ‹ Umi ç‰ˆæœ¬ umi --version Umi å¿«é€Ÿæ­å»ºé¡¹ç›®åˆ›å»ºè¿›å…¥ç›®å½•åï¼Œä½¿ç”¨ç»ˆç«¯å·¥å…·è¾“å…¥ # è„šæ‰‹æ¶å·¥å…·ï¼Œå¿«é€Ÿæ­å»ºé¡¹ç›® yarn create umi é€‰æ‹©é¡¹ç›®ç±»å‹ è¿™é‡Œæˆ‘é€‰æ‹©äº† ant-design-pro ~ ? Select the boilerplate type (Use arrow keys) ant-design-pro - Create project with an layout-only ant-design-pro boilerplate, use together with umi block. â¯ app - Create project with a simple boilerplate, support typescript. block - Create a umi block. library - Create a library with umi. plugin - Create a umi plugin. ç„¶åé€‰æ‹©æ˜¯å¦ä½¿ç”¨ TypeScriptï¼Œæ¨èä½¿ç”¨TypeScriptï¼Œè¾“å…¥yåå›è½¦ç»“æŸ çœ‹å–œå¥½å§ï¼Œtsä¸å¤ªç†Ÿï¼Œç›´æ¥jsäº† ? Do you want to use typescript? (y/N) é¡¹ç›®åˆ›å»ºå®Œæˆ# å¯åŠ¨é¡¹ç›® yarn start / umi dev é¡¹ç›®ç»“æ„åˆ†æ. â”œâ”€â”€ config â”œâ”€â”€ config.js // ** åŒ…å«é¡¹ç›®çš„åŸºæœ¬é…ç½®ï¼Œå¦‚æœæ’ä»¶ï¼Œè·¯ç”±é…ç½® â”œâ”€â”€ proxy.js // å‰ç«¯ä»£ç† â”œâ”€â”€ mock // mockæ•°æ® â”œâ”€â”€ node_modules â”œâ”€â”€ dist // æ‰“åŒ…è¾“å‡º â”œâ”€â”€ public â”œâ”€â”€ src â”œâ”€â”€ assets // é™æ€èµ„æº â”œâ”€â”€ *components // å…¬å…±ç»„ä»¶ è‡ªå·±åˆ›å»º â”œâ”€â”€ layouts // å…¨å±€é¡µé¢å¸ƒå±€ â”œâ”€â”€ models // saga modelsæ”¾å…¨å±€çš„ â”œâ”€â”€ pages/ // routeré¡µé¢ umiçº¦å®šåç§° â”œâ”€â”€ document.ejs // HTML template â”œâ”€â”€ helloworld.jsx // é¡µé¢ï¼Œå¯¼å‡ºreactç»„ä»¶ â”œâ”€â”€ *services // æ¥å£ è‡ªå·±åˆ›å»º â”œâ”€â”€ *utils // å…¨å±€æ–¹æ³• è‡ªå·±åˆ›å»º â”œâ”€â”€ locales // ** è¯­è¨€é…ç½®ï¼ŒMenué…ç½®ç­‰ â”œâ”€â”€ global.less â”œâ”€â”€ tests â”œâ”€â”€ package.json ... ... æ¥ä¸‹æ¥çœ‹çœ‹Umiçš„åŸºæœ¬ä½¿ç”¨å§ â€”â€”&gt; UmiåŸºæœ¬ä½¿ç”¨å¦‚ä½•åˆ›å»ºé¡µé¢ï¼Ÿ ä½¿ç”¨ç»ˆç«¯å·¥å…·è¾“å…¥å‘½ä»¤ # åœ¨pageç›®å½•ä¸‹ åˆ›å»º channel æ–‡ä»¶å¤¹å¹¶åœ¨é‡Œé¢åˆ›å»ºindex.jsæ–‡ä»¶ï¼Œå¹¶åˆå§‹åŒ–cssæ–‡ä»¶ä¸º less æ ¼å¼ umi g page channel/index --less å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åˆ›å»ºæ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„å½¢å¼åˆ›å»ºé¡µé¢ è·¯ç”±é…ç½®æ¥ä¸‹æ¥æˆ‘ä»¬é…ç½®ä¸€ä¸‹è·¯ç”± // config/config.js ä¸­æ³¨å†Œ è·¯ç”± routes: [ ... ... + { + name: &#39;channel&#39;, + icon: &#39;table&#39;, + path: &#39;/channel&#39;, + component: &#39;./channel&#39; + }, ... ... ] ä»¥ä¸Šæˆ‘ä»¬å°±é…ç½®å¥½äº†è·¯ç”±ï¼Œåœ¨åœ°å€æ ç›´æ¥è¾“å…¥ /channel å°±å¯ä»¥è®¿é—®äº† è¿™é‡Œæˆ‘ä»¬ç”¨åˆ°äº† Antd çš„æ¡†æ¶ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬é…ç½®å¥½çš„è·¯ç”±å°±ä¼šå‡ºç°åœ¨ä¾§è¾¹æ ä¸Šå•¦ ä½†æ˜¯channelæ€ä¹ˆæ˜¾ç¤ºä¸ºä¸­æ–‡å‘¢ï¼Ÿé‚£ä¹ˆæ¥çœ‹çœ‹æ€ä¹ˆé…ç½® ä¾§è¾¹å¯¼èˆªæ  // .src/locales/zh-CN/menu.js // æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æ‰‹åŠ¨çš„é…ç½®æˆ‘ä»¬çš„ä¾§è¾¹å¯¼èˆªæ  export default { &#39;menu.welcome&#39;: &#39;æ¬¢è¿&#39;, &#39;menu.channel&#39;: &#39;æ¸ é“&#39;, &#39;menu.more-blocks&#39;: &#39;æ›´å¤šåŒºå—&#39;, &#39;menu.home&#39;: &#39;é¦–é¡µ&#39;, + &#39;menu.channel&#39;: &#39;é¢‘é“&#39; // ä»¥ menu.name çš„å½¢å¼æ¥é…ç½® ... ... }; å°±æ­¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°±æ­¤æ¥å†™ä¸€ä¸ªç®€å•çš„Demoäº†ã€‚ æŸ¥è¯¢è¡¨æ ¼Demoè¿™é‡Œæˆ‘ä»¬å°±ç®€å•çš„ç¼–å†™ä¸ªæŸ¥è¯¢è¡¨æ ¼çš„Demoå§ é¡µé¢ç¼–å†™é¦–å…ˆæˆ‘ä»¬å…ˆå°†é¡µé¢å¸ƒå±€æ¥æ•´æ•´å§ï¼Œé¡µé¢å¸ƒå±€å¾ˆç®€å•ï¼Œç›´æ¥ä¸Šä»£ç  import React, { Component } from &#39;react&#39;; import styles from &#39;./index.less&#39;; import { PageHeaderWrapper } from &#39;@ant-design/pro-layout&#39;; import { Form, Input, Card, Table, Button } from &#39;antd&#39; let columns = [ { title: &#39;å§“å&#39;, dataIndex: &#39;name&#39;, key: &#39;name&#39;, }, { title: &#39;å¹´é¾„&#39;, dataIndex: &#39;age&#39;, key: &#39;age&#39;, }, { title: &#39;åŸå¸‚&#39;, dataIndex: &#39;city&#39;, key: &#39;city&#39;, }, ] class Channel extends Component { render() { return ( &lt;PageHeaderWrapper&gt; &lt;div&gt; &lt;Card className={styles.channel}&gt; &lt;Form&gt; &lt;Form.Item label=&quot;å§“å&quot;&gt; &lt;Input /&gt; &lt;/Form.Item&gt; &lt;Form.Item&gt; &lt;Button type=&quot;primary&quot; &gt;æœç´¢&lt;/Button&gt; &lt;/Form.Item&gt; &lt;/Form&gt; &lt;/Card&gt; &lt;Card&gt; &lt;Table dataSource={[]} columns={columns} /&gt; &lt;/Card&gt; &lt;/div&gt; &lt;/PageHeaderWrapper&gt; ) } } export default Channel æ¥çœ‹ä¸‹æ•ˆæœå›¾ ojbkï¼Œæ¥ä¸‹æ¥å…ˆæŠŠè¡¨æ ¼çš„æ•°æ®æ¸²æŸ“å‡ºæ¥å§ æ¸²æŸ“è¡¨æ ¼æ•°æ®è¿™é‡Œå‘¢ï¼Œå¤§è‡´çš„é€»è¾‘å°±æ˜¯ï¼š é¦–å…ˆå‘é€è¯·æ±‚æ‹¿å–æ•°æ®ï¼Œ ç„¶åå­˜æ”¾åˆ°reduxä¸­ï¼Œ é¡µé¢åˆ°reduxä¸­è·å–æ•°æ®ï¼Œ æœ€åæ¸²æŸ“å³å¯ã€‚ é‚£ä¹ˆæˆ‘ä»¬è¿™é‡ŒUmié‡Œé›†æˆå¥½äº†dvaï¼Œé‚£æˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨dvaæ¥ä»£æ›¿åŸç”Ÿçš„reduxäº† // src/models/channel.js import { getChannelDataAJAX } from &#39;../services/channel&#39; const Model = { namespace: &#39;channel&#39;, // å‘½åç©ºé—´ state: { // è¯¥Modelå½“å‰çš„çŠ¶æ€ï¼Œæ•°æ®éƒ½å­˜ç€ data: [] }, effects: { // è¯·æ±‚æ•°æ®ï¼Œå¤„ç†å¼‚æ­¥ï¼Œé‡Œé¢éƒ½æ˜¯Generatorå‡½æ•° *getChannelData({payload}, {call, put}) { // getChannelDataAJAX å°±æ˜¯ä¸ªå°è£…å¥½çš„AJAxè¯·æ±‚ const res = yield call(getChannelDataAJAX, payload) // callæ‰§è¡Œå¼‚æ­¥å‡½æ•° yield put({type: &#39;channelData&#39;, payload: res}) // putå‘å‡ºä¸€ä¸ªAction }, }, reducers: { // æ›´æ–°æ•°æ®ï¼ŒActionå¤„ç†å™¨ï¼Œå¤„ç†åŒæ­¥åŠ¨ä½œï¼Œæ›´æ–°StateçŠ¶æ€ channelData(state, {payload}){ // å¯¹åº” put({type: &#39;channelData&#39;) return {...state, data: [...payload.data]} // æ›´æ–° State çš„çŠ¶æ€ }, } } export default Model åˆ°æ­¤ï¼Œæˆ‘ä»¬è¯·æ±‚å¥½äº†æ•°æ®å¹¶æ”¾åœ¨äº†reduxä¸Šå•¦ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è®©é¡µé¢è·å–åˆ°reduxé‡Œçš„æ•°æ®å°±okäº† é¡µé¢æƒ³è¦è·å–reduxé‡Œçš„æ•°æ®æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ connect è¿æ¥redux å…ˆçœ‹æœ€åä¸€æ®µçš„ connect è¿æ¥ import React, { Component } from &#39;react&#39;; import styles from &#39;./index.less&#39;; import { PageHeaderWrapper } from &#39;@ant-design/pro-layout&#39;; import { Form, Input, Card, Table, Button } from &#39;antd&#39; import { connect } from &#39;dva&#39;; let columns = [ ... ... ] class Channel extends Component { componentDidMount(){ // console.log(this.props) this.props.getChannelData() // 3. é¡µé¢æŒ‚è½½åï¼Œè¯·æ±‚æ•°æ®ï¼Œä¿å­˜å…¥redux } render() { let { data } = this.props // 4. è·å–åˆ°æŒ‚è½½åˆ°this.propsä¸Šçš„dataï¼Œå¹¶è§£æ„å‡ºæ¥ return ( &lt;PageHeaderWrapper&gt; &lt;div&gt; &lt;Card className={styles.channel}&gt; &lt;Form&gt; &lt;Form.Item label=&quot;å§“å&quot;&gt; &lt;Input /&gt; &lt;/Form.Item&gt; &lt;Form.Item&gt; &lt;Button type=&quot;primary&quot;&gt;æœç´¢&lt;/Button&gt; &lt;/Form.Item&gt; &lt;/Form&gt; &lt;/Card&gt; &lt;Card&gt; {/* 5. ç„¶åè¿™é‡Œå°±å¯ä»¥ç›´æ¥æ¸²æŸ“å‡ºæ¥å•¦ */} &lt;Table dataSource={data} columns={columns} /&gt; &lt;/Card&gt; &lt;/div&gt; &lt;/PageHeaderWrapper&gt; ) } } export default connect( // 1. mapStateToProps å°† reduxé‡Œçš„stateæ˜ å°„åˆ°this.propsä¸Š // {channel} å°±è¡¨ç¤º state.channel =&gt; ({...channel}) ({channel}) =&gt; ({...channel}), // 2. mapReducerToProps å°†dispatchçš„æ–¹æ³•æ˜ å°„åˆ°this.propsä¸Š { getChannelData: () =&gt; ({type: &#39;channel/getChannelData&#39;}) } )(Channel) Lookï¼Œæ•°æ®æ¸²æŸ“å‡ºæ¥å•¦ã€‚ æ¥ä¸‹æ¥å°±ç»§ç»­å®ç°æœç´¢è¿™ä¸ªå°åŠŸèƒ½å§ æœç´¢åŠŸèƒ½æœç´¢åŠŸèƒ½å¤§è‡´çš„é€»è¾‘ï¼š é¦–å…ˆåœ¨è¾“å…¥æ¡†è¾“å…¥è¦æœç´¢çš„å…³é”®å­— è¾“å…¥å®Œåè§¦å‘æ–¹æ³•ï¼Œå‘é€è¯·æ±‚åˆ°åç«¯ è¯·å°†å“åº”çš„ç»“æœè¿”å›ï¼Œå¹¶æ›´æ–°reduxå³å¯ é‚£é¦–å…ˆæ¥çœ‹çœ‹dvaé‡Œçš„Modelå†…å®¹å§ï¼Œæ•´ä¸ªæœç´¢çš„é€»è¾‘å’Œé¦–æ¬¡è·å–æ•°æ®ç±»ä¼¼ import { getChannelData, getChannelDataBySearchAJAX} from &#39;../services/channel&#39; const Model = { namespace: &#39;channel&#39;, state: { data: [] }, effects: { *getChannelData({payload}, {call, put}) { const res = yield call(getChannelData, payload) yield put({type: &#39;channelData&#39;, payload: res}) }, // è¿™é‡Œæ˜¯è§¦å‘æœç´¢çš„æ—¶å€™å‘é€çš„å¼‚æ­¥æ“ä½œ *getChannelDataBySearch({payload}, {call, put}){ // console.log(payload) // getChannelDataBySearchAJAX å‘é€æœç´¢çš„AJAX const res = yield call(getChannelDataBySearchAJAX, payload) // console.log(res) // è§¦å‘ reducers ä¸­çš„ channelDataBySearch yield put({type: &#39;channelDataBySearch&#39;, payload: res}) } }, reducers: { channelData(state, {payload}){ return {...state, data: [...payload.data]} }, // å°†è·å–åˆ°çš„ç»“æœåšä¸ªæ›´æ–° channelDataBySearch(state, {payload}){ return {...state, data: [...payload.data]} } } } export default Model ç„¶åæˆ‘ä»¬æœ€åæ¥çœ‹çœ‹é¡µé¢æ€ä¹ˆå¤„ç†çš„å§ å› ä¸ºæœ‰ä¸ªè¾“å…¥æ¡†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°†è¾“å…¥çš„å†…å®¹ä¿å­˜ä¸‹æ¥ å¹¶ä¸”è¾“å…¥çš„å†…å®¹æ”¹å˜æ—¶è§¦å‘this.setState()æ¥ä¿®æ”¹Stateé‡Œçš„æ•°æ® ç»™ButtonæŒ‰é’®ç»‘å®šæ–¹æ³•å¯ä»¥dispatch import React, { Component } from &#39;react&#39;; import styles from &#39;./index.less&#39;; import { PageHeaderWrapper } from &#39;@ant-design/pro-layout&#39;; import { Form, Input, Card, Table, Button } from &#39;antd&#39; import { connect } from &#39;dva&#39;; let columns = [... ...] class Channel extends Component { constructor(props){ super(props) this.state = { name: &#39;&#39; // 1. è¾“å…¥çš„å†…å®¹ä¿å­˜åœ¨è¿™é‡Œå“¦ } } componentDidMount(){ // console.log(this.props) this.props.getChannelData() } setName = (event) =&gt; { // 2. è¿™æ˜¯ä¿®æ”¹ stateé‡Œnameçš„æ–¹æ³• this.setState({ name: event.target.value }) } search = () =&gt; { // è§¦å‘æœç´¢çš„dispatchæ–¹æ³• const { name } = this.state // console.log(name) this.props.getChannelDataBySearch(name) } render() { let { data } = this.props const { name } = this.state return ( &lt;PageHeaderWrapper&gt; &lt;div&gt; &lt;Card className={styles.channel}&gt; &lt;Form&gt; &lt;Form.Item label=&quot;å§“å&quot;&gt; {/* ç»‘å®švalueï¼Œä»¥åŠä¿®æ”¹stateçŠ¶æ€çš„æ–¹æ³• */} &lt;Input value={name} onChange={this.setName} /&gt; &lt;/Form.Item&gt; &lt;Form.Item&gt; {/* ç»‘å®š è§¦å‘æœç´¢çš„æ–¹æ³• */} &lt;Button type=&quot;primary&quot; onClick={this.search}&gt;æœç´¢&lt;/Button&gt; &lt;/Form.Item&gt; &lt;/Form&gt; &lt;/Card&gt; &lt;Card&gt; &lt;Table dataSource={data} columns={columns} rowKey={({id}) =&gt; id} /&gt; &lt;/Card&gt; &lt;/div&gt; &lt;/PageHeaderWrapper&gt; ) } } export default connect( ({channel}) =&gt; ({...channel}), { getChannelData: () =&gt; ({type: &#39;channel/getChannelData&#39;}), // 3. dispatchçš„æ–¹æ³• getChannelDataBySearch: (name) =&gt; ({type: &#39;channel/getChannelDataBySearch&#39;, payload: {name}}) } )(Channel) å””ï¼Œå°±æ­¤ï¼Œæœç´¢åŠŸèƒ½å®Œæˆå•¦ å¥½äº†ï¼Œè¿™å°±æ˜¯ä¸ªå°å°çš„Demoï¼Œç”¨æ¥åˆæ¢Umi~","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"http://blog.hjiya.cn/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"http://blog.hjiya.cn/categories/æŠ€æœ¯/"}]},{"title":"react","slug":"react","date":"2020-03-26T02:58:19.000Z","updated":"2020-03-26T03:44:11.303Z","comments":true,"path":"2020/03/26/react/","link":"","permalink":"http://blog.hjiya.cn/2020/03/26/react/","excerpt":"","text":"React å…¥é—¨ç¬”è®°React åº”ç”¨åˆ›å»ºæ–¹æ³•ä½¿ç”¨ create react app è„šæ‰‹æ¶å‘½ä»¤å¿«é€Ÿåˆ›å»º Reactåº”ç”¨ npx create-react-app name ç®€å•ä½¿ç”¨åœ¨ index.js ä¸­æ¸²æŸ“ä¸Šé¡µé¢çš„æ ¸å¿ƒä»£ç  import React from &#39;react&#39; import ReactDOM from &#39;react-dom&#39; // åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„Reactå…ƒç´  const app = &lt;h1&gt;Welcome React&lt;/h1&gt; ReactDOM.render( app, document.querySelector(&#39;#root&#39;) ) åˆ›å»ºç»„ä»¶ä½¿ç”¨å‡½æ•°åˆ›å»ºç»„ä»¶const App = (props) =&gt; { return ( &lt;div&gt; &lt;h1&gt;welcome {props.title}&lt;/h1&gt; &lt;/div&gt; ) } ReactDOM.render( &lt;App title=&quot;1901&quot;/&gt;, document.querySelector(&#39;#root&#39;) ) Classç±»åˆ›å»ºç»„ä»¶import React from &#39;react&#39; import {render} from &#39;react-dom&#39; // å®šä¹‰ç»„ä»¶çš„ç¬¬äºŒç§æ–¹å¼ --&gt; ç±» class App extends React.Component { render(){ return ( &lt;div&gt; &lt;h1&gt;Welcome React {this.props.title}&lt;/h1&gt; &lt;/div&gt; ) } }; render( &lt;App title=&#39;2019&#39;/&gt;, document.querySelector(&#39;#root&#39;) ); // åº•å±‚åŸç† // &lt;App title=&quot;2019&quot; /&gt; ç¼–è¯‘æˆä»¥ä¸‹ä»£ç  // const app = new App({ // title: &quot;2019&quot; // }).render() jsx åŸç†è™šæ‹ŸDOMæ ‘æ–¹å¼ React.createElemet(type,[props],[â€¦children]) æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºåˆ›å»ºå…ƒç´ ï¼Œå‚æ•°ï¼šï¼ˆæ ‡ç­¾åï¼Œæ ‡ç­¾å±æ€§ï¼Œå­å…ƒç´ â€¦ï¼‰ // class App extends Component { // render(){ // return ( // &lt;div&gt; // &lt;h1&gt;Welcome React&lt;/h1&gt; // &lt;/div&gt; // ) // } // } // åº•å±‚ç¼–è¯‘ä¸º ä»¥ä¸‹æ–¹å¼ class App extends Component { render(){ return ( React.createElement( &#39;div&#39;, { className: &#39;dv1&#39;, id: &#39;appRoot&#39; }, React.createElement( &#39;h1&#39;, { className: &#39;title&#39;, }, &#39;Welcome React&#39; ) ) ) } } æ ·å¼ç±»åçš„ç»‘å®š å†…è”æ ·å¼åˆ›å»º ä½¿ç”¨ styled-components æ’ä»¶ å®šä¹‰æ ·å¼ç»„ä»¶ï¼Œå†ä½¿ç”¨æ ·å¼ç»„ä»¶åŒ…è£¹ ä½¿ç”¨ className çš„æ–¹æ³•ç›´æ¥æ·»åŠ  ç±»å ä½¿ç”¨ classnames æ’ä»¶ï¼ŒåŠ¨æ€æ·»åŠ  ç±»å // å®šä¹‰æ ·å¼ç»„ä»¶ const Title = styled.h1` color: red ` const Header = () =&gt; &lt;h1&gt;hi&lt;/h1&gt; // å®šä¹‰ç»„ä»¶çš„ç¬¬äºŒç§æ–¹å¼ --&gt; ç±» class App extends Component { render(){ // ä½¿ç”¨å†…è”æ ·å¼åˆ›å»º const style = {color: &quot;red&quot;} return ( &lt;div&gt; &lt;Header /&gt; &lt;h1 style={style}&gt;Welcome React {this.props.title}&lt;/h1&gt; {/* ä½¿ç”¨ className æ–¹å¼ æ³¨æ„è¿™é‡Œæ ·å¼ç±»åéœ€è¦ className è€Œä¸æ˜¯ class */} &lt;h1 className=&quot;has-test-pink&quot;&gt;Welcome React {this.props.title} 2&lt;/h1&gt; {/* ä½¿ç”¨ classnames æ’ä»¶ ç»‘å®šåŠ¨æ€æ ·å¼ */} &lt;h1 className={classNames(&#39;a&#39;,{&#39;has-test-pink&#39;: true})}&gt;Welcome React {this.props.title} 3&lt;/h1&gt; {/* ä½¿ç”¨å®šä¹‰å¥½çš„æ ·å¼ç»„ä»¶ */} &lt;Title className={classNames(&#39;a&#39;,{&#39;has-test-pink&#39;: true})}&gt;Welcome React {this.props.title} 4&lt;/Title&gt; &lt;/div&gt; ) } } å‘å­ç»„ä»¶ä¼ å€¼åšç±»å‹æ£€æŸ¥prop-types å‡½æ•°ç»„ä»¶çš„ç±»å‹æ£€æŸ¥æ–¹æ³• &lt;TodoHeader title=&quot;ä»£åŠäº‹é¡¹&quot; x={1} y={2}&gt; hi &lt;/TodoHeader&gt; TodoHeader.propTypes = { title: PropTypes.string, x: PropTypes.number.isRequired, // è¿™é‡Œå¯ä»¥é“¾å¼æ“ä½œ y: PropTypes.number, } ç±»ç»„ä»¶çš„ç±»å‹æ£€æŸ¥æ–¹æ³• &lt;TodoInput btnText=&quot;æ·»åŠ å§&quot;/&gt; export default class TodoInput extends Component { // é™æ€å±æ€§ static propTypes = { btnText: PropTypes.string } render() { return ( &lt;div&gt; &lt;input /&gt;&lt;button&gt;{this.props.btnText}&lt;/button&gt; &lt;/div&gt; ) } } å­ç»„ä»¶ä¼ å‚è®¾ç½®é»˜è®¤å€¼ å‡½æ•°ç»„ä»¶è®¾ç½®é»˜è®¤å€¼TodoHeader.defaultProps = { title: &#39;Welcome&#39; } ç±»ç»„ä»¶è®¾ç½®é»˜è®¤å€¼export default class TodoInput extends Component { static propTypes = { btnText: PropTypes.string } static defaultProps = { btnText: &#39;æ·»åŠ &#39; } render() { return ( &lt;div&gt; &lt;input /&gt;&lt;button&gt;{this.props.btnText}&lt;/button&gt; &lt;/div&gt; ) } } ç»„ä»¶è‡ªå·±çš„æ•°æ®çŠ¶æ€class ç±»ç»„ä»¶ -æœ‰çŠ¶æ€ç»„ä»¶function å‡½æ•°ç»„ä»¶ -æ— çŠ¶æ€ç»„ä»¶ï¼ˆHookæœ‰è§£å†³åŠæ³•ï¼‰ ä½¿ç”¨ this.state.name æ¥è·å–æ•°æ® state åªæœ‰ classç±»ç»„ä»¶æ‰ä¼šæœ‰ export default class App extends Component { // æ–¹æ³•ä¸€ // state = { // title: &#39;ä»£åŠäº‹é¡¹App&#39; // } // æ–¹æ³•äºŒ constructor(){ super() this.state = { title: &#39;å¾…åŠäº‹é¡¹App&#39; } } render() { return ( &lt;Fragment&gt; &lt;TodoHeader title={this.state.title} x={1} y={2}&gt; hi &lt;/TodoHeader&gt; &lt;TodoInput btnText=&quot;æ·»åŠ å§&quot;/&gt; &lt;TodoList /&gt; {this.state.title} &lt;/Fragment&gt; ) } } æ¸²æŸ“æ•°æ® ç›´æ¥æ¸²æŸ“{this.state.name} htmlæ–‡æœ¬æ¸²æŸ“(Vueä¸­çš„v-html) &lt;div dangerouslySetInnerHTML={{__html: this.state.htxt}} /&gt; åˆ—è¡¨æ¸²æŸ“ this.props.todos.map(item=&gt;{ return ( &lt;TodoItem key={item.id} {...item} /&gt; ) }) ä¿®æ”¹æ•°æ®ä½¿ç”¨ this.setState() çš„æ–¹æ³•æ¥ä¿®æ”¹æ•°æ® this.setState() éœ€è¦ä¸¤ä¸ªå‚æ•° ç¬¬ä¸€ä¸ªå‚æ•°åˆæœ‰ä¸¤ç§æƒ…å†µç¬¬ä¸€ç§æƒ…å†µæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼š handleLikeClick = () =&gt; { // éœ€è¦ä½¿ç”¨ setState ä¿®æ”¹æ•°æ® this.setState({ isLike: !this.state.isLike }) } ç¬¬äºŒç§æƒ…å†µæ˜¯ä¸€ä¸ªæ–¹æ³•ï¼š æ–¹æ³•ä¸­æœ‰ä¸ªå‚æ•°ï¼Œä¿å­˜ç€ä¿®æ”¹æ•°æ®å‰çš„æ•°æ® this.setState((prev)=&gt;{ console.log(prev) return { isLike: !this.state.isLike } }) ç¬¬äºŒä¸ªå‚æ•°ä¸ºä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ¥è·å–æœ€æ–°çš„æ•°æ®çŠ¶æ€this.setState((prev)=&gt;{ console.log(prev) return { isLike: !this.state.isLike } },()=&gt;{ console.log(this.state.isLike) }) setState ç‰¹æ€§ setStateæ˜¯å¼‚æ­¥æ“ä½œ â½¤setStateæ›´æ–°çŠ¶æ€â½½ä¸èƒ½ç›´æ¥ä¿®æ”¹ this.state.counter += 1; //é”™è¯¯çš„ ä¸”setStateæ˜¯æ‰¹é‡æ‰§è¡Œçš„ï¼Œå› æ­¤å¯¹åŒä¸€ä¸ªçŠ¶æ€æ‰§è¡Œå¤šæ¬¡åªèµ·ä¸€æ¬¡ä½œç”¨ï¼Œå¤šä¸ªçŠ¶æ€æ›´æ–°å¯ä»¥æ”¾åœ¨åŒä¸€ä¸ªsetStateä¸­è¿›è¡Œ componentDidMount(){ this.setState({counter: this.state.counter + 1}); this.setState({counter: this.state.counter + 1}); this.setState({counter: this.state.counter + 1}); } // æœ€å Counterçš„å€¼ä¸º 1 ï¼ˆsetStateåªæœ‰åœ¨åˆæˆäº‹ä»¶å’Œé’©â¼¦å­å‡½æ•°ä¸­æ˜¯å¼‚æ­¥çš„ï¼Œåœ¨åŸç”Ÿäº‹ä»¶å’ŒsetTimeoutã€setIntervalä¸­éƒ½æ˜¯åŒæ­¥çš„ï¼‰ ä½¿å…¶åŒæ­¥çš„æ–¹æ³• ç¬¬ä¸€ç§æ–¹æ³• å¦‚ä¸Šthis.setState() ä¼ å…¥å›è°ƒå‡½æ•° ç¬¬äºŒç§æ–¹æ³•å°±æ˜¯åŸç”Ÿäº‹ä»¶ componentDidMount(){ document.getElementsByTagName(&#39;button&#39;)[0].addEventListener(&#39;click&#39;, () =&gt; { this.setState({ counter: this.state.counter + 2 }) }) } ç¬¬ä¸‰ç§å°±æ˜¯å®šæ—¶å™¨ handleLikeClick = () =&gt; { setTimeout(() =&gt; { this.setState({ counter: this.state.counter + 1 }) }, 0); } äº‹ä»¶onClickï¼ŒonChangeâ€¦. æ–¹æ³•ä¸€ &lt;input onChange={this.handleInputChange} type=&quot;text&quot; value={this.state.inputValue}/&gt; handleInputChange = (e)=&gt; { this.setState({ inputValue: e.currentTarget.value }) } æ–¹æ³•äºŒï¼šå¯ä»¥ä¼ é€’å‚æ•° &lt;button onClick={this.handleClick.bind(this,123)}&gt;{this.props.btnText}&lt;/button&gt; handleClick(num){ console.log(this.state.inputValue,num) } äº‹ä»¶ä¼ å‚ å¤–é¢å†åŒ…å±‚åŒ¿åå‡½æ•°ï¼Œå› ä¸ºä½¿ç”¨è¿™ç§äº‹ä»¶æ˜¯åŒ¿åå‡½æ•°ï¼Œæ¸²æŸ“çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œæ‰€ä»¥å¤–é¢å†åŠ å±‚åŒ¿åå‡½æ•° &lt;button onClick={() =&gt; { this.handleBtnClick(123) }}&gt;äº‹ä»¶ä¼ å‚&lt;/button&gt; ä½¿ç”¨.bind(this,å‚æ•°åˆ—è¡¨) hook é’©å­å‡½æ•°hook é’©å­å‡½æ•°å¯ä»¥ä½¿ å‡½æ•°ç»„ä»¶ä¹Ÿèƒ½æ‹¥æœ‰ ç±»ç»„ä»¶ä¸­è‡ªå·±çš„çŠ¶æ€å’Œå…¶ä»–ç‰¹æ€§ // éœ€è¦å¯¼å…¥ useState useEffect hookæ¥å®Œæˆæ“ä½œ import React, { useState, useEffect } from &#39;react&#39; export default function User() { // const date = new Date() const [date, setDate] = useState(new Date()) // ä¸€ä¸ªå˜é‡å®šä¹‰ä¸€æ¬¡ useEffect(() =&gt; { const timeid = setInterval(() =&gt; { setDate(new Date()) }, 1000) return () =&gt; clearInterval(timeid) }) return ( &lt;div&gt; &lt;h1&gt;{date.toLocaleTimeString()}&lt;/h1&gt; &lt;/div&gt; ) } ç»„ä»¶é€šè®¯props// çˆ¶ç»„ä»¶ &lt;Search store={store} title=&quot;props&quot; tellme={tellme} /&gt; // å­ç»„ä»¶ // this.props.title this.props.tellme çš„å½¢å¼æ¥æ¥æ”¶ createContext æ˜¯ react æä¾›çš„è·¨ç»„ä»¶çš„æ–¹æ³•createContext è¿™ä¸ªæ–¹æ³•çš„ç»“æœæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢æœ‰2ä¸ªç»„ä»¶ï¼ŒProviderå’ŒConsumer Provider ç”¨äºæä¾›çŠ¶æ€ Consumer ç”¨äºæ¥æ”¶çŠ¶æ€ // æƒ³è§£æ„å‡ºæ¥ const { Provider, Consumer:CounterConsumer } = createContext() class CounterProvider extends Component { constructor(){ super() // è¿™é‡Œçš„çŠ¶æ€æ˜¯å…±äº«çš„ï¼Œä»»ä½•CounterProviderçš„å­å­™ç»„ä»¶ï¼Œéƒ½å¯ä»¥ä½¿ç”¨CounterConsumeræ¥æ¥æ”¶ this.state = { count: 100 } } // è¿™é‡Œçš„æ–¹æ³•ä¹Ÿä¼šç»§ç»­é€šè¿‡Providerå…±äº«ä¸‹å» incrementCount = () =&gt; { this.setState({ count: this.state.count + 1 }) } decrementCount = () =&gt; { this.setState({ count: this.state.count - 1 }) } render(){ return ( // ä½¿ç”¨ Provider è¿™ä¸ªç»„ä»¶ ï¼Œå¿…é¡»æœ‰ä¸ªvalueå€¼ï¼Œè¿™ä¸ªValueä¸­ç§‘é™¢ä¼ é€’ä»»ä½•çš„æ•°æ®ï¼Œä¸€èˆ¬ä¼ é€’ä¸€ä¸ªå¯¹è±¡ &lt;Provider value={{count: this.state.count, onIncrementCount: this.incrementCount, onDecrementCount:this.decrementCount}}&gt; {this.props.children} &lt;/Provider&gt; ) } } // å®šä¹‰çš„å­å­™ç»„ä»¶ï¼Œä½¿ç”¨ CounterConsumer æ¥æ¥æ”¶count class Counter extends Component { render(){ return ( &lt;CounterConsumer&gt; { //æ³¨æ„ï¼Œè¿™é‡Œçš„CounterConsumeråŒ…è£¹ç€çš„å¿…é¡»æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œ //å‚æ•°æ˜¯Provideræä¾›çš„Value ({count}) =&gt; { return &lt;span&gt;{count}&lt;/span&gt; } } &lt;/CounterConsumer&gt; ) } } HOC é«˜é˜¶ç»„ä»¶ Height-order componentå¯ä»¥åŠ«æŒé¡µé¢æ¸²æŸ“ // App.js import React, { Component } from &#39;react&#39; // å¯¼å…¥ é«˜é˜¶ç»„ä»¶ import witCopyright from &#39;./witCopyright&#39; class App extends Component { render(){ return ( &lt;div&gt; &lt;h1&gt;h&lt;/h1&gt; &lt;/div&gt; ) } } // ä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼Œå¹¶å°† App ç»„ä»¶ ä½œä¸ºå‚æ•°ä¼ å…¥ export default witCopyright(App) // é«˜é˜¶ç»„ä»¶ witCopyright.js import React, { Component } from &#39;react&#39; const witCopyright = (YourComponent) =&gt; { return class witCopyright extends Component { render() { return ( &lt;&gt; è¿™é‡Œå°±æ˜¯ åˆšæ‰ä¼ å…¥å‡½æ•°ï¼Œå°†å…¶ä½¿ç”¨ è¿™é‡Œæ³¨æ„ è¦ä½¿ç”¨ {...this.props} æ›´æ”¹ props &lt;YourComponent {...this.props}/&gt; &lt;div&gt;&amp;copy; 2019 &amp;emsp; é»„å³å‘€&lt;/div&gt; &lt;/&gt; ) } } } export default witCopyright ä½¿ç”¨è£…é¥°å™¨ è£…é¥°é«˜é˜¶ç»„ä»¶çš„å†™æ³•å®‰è£…åŒ… ç¬¬ä¸€æ­¥ npm i react-app-rewired â€“sava-dev ç„¶åä¿®æ”¹ page.json æ–‡ä»¶ï¼Œä¿®æ”¹ä¸º react-app-rewired &quot;scripts&quot;: { &quot;start&quot;: &quot;react-app-rewired start&quot;, &quot;build&quot;: &quot;react-app-rewired build&quot;, &quot;test&quot;: &quot;react-app-rewired test&quot;, &quot;eject&quot;: &quot;react-scripts eject&quot; } ç„¶åå† é¡¹ç›®ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª config-overrides.js å³å¯ // config-overrides.js module.exports = (config) =&gt; { // åœ¨è¿™é‡Œå¯ä»¥å¯¹ config è¿›è¡Œé…ç½® return config } ç¬¬äºŒæ­¥ å®‰è£… customize-cra æ¥æ–¹ä¾¿å®šä¹‰é…ç½®é¡¹ npm i customize-cra â€“sava-dev ä¿®æ”¹ config-overrides.js const {override,addDecoratorsLegacy} = require(&#39;customize-cra&#39;) module.exports = override( addDecoratorsLegacy() ) npm i @babel/plugin-proposal-decorators -D çŠ¶æ€ç®¡ç† redux æ‰‹åŠ¨è¿æ¥æ‰‹åŠ¨å®ç° redux çŠ¶æ€ç®¡ç†ç®€å•çš„reduxçš„å®ç° ï¼Œ è¯¦æƒ…è§ redux-pronciple-2.html const countState = { count: 5 } const changeState = (state,action) =&gt; { if(!state){ return countState } switch(action.type){ default: return state; case &quot;JIAN&quot;: return { ...state, count: state.count - action.n } break; case &quot;JIA&quot;: return { ...state, count: state.count + action.n } } } const createStore = (reducer) =&gt; { let state = null const getState = () =&gt; state const Listeners = [] const subScribe = (Listener) =&gt; Listeners.push(Listener) const dispatch = (action) =&gt; { state = changeState(state,action) Listeners.forEach(listener =&gt; listener()) } dispatch({}) return { getState, dispatch, subScribe } } const store = createStore(changeState) const renderCount = () =&gt; { countDisplay.innerHTML = store.getState().count } renderCount() store.subScribe(renderCount) ä½¿ç”¨ redux é¦–å…ˆåœ¨ srcç›®å½•ä¸‹æ–°å»º 2ä¸ª æ–‡ä»¶å¤¹ reducers actions ç„¶ååœ¨ src ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼šstore.js`jsimport { createStore } from â€˜reduxâ€™// å¯¼å…¥ reducersimport rootReducer from â€˜./reducersâ€™ export default createStore(rootReducer) - åœ¨reducersæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª car.js å¹¶å¯¼å‡º ```js const initState = [] export default (state = initState,action) =&gt; { switch(action.type){ default: return state } } åœ¨reducersæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª index.js æ–‡ä»¶ç”¨æ¥åˆå¹¶å¯¼å‡ºreducersä¸­çš„å…¶ä»–æ–‡ä»¶`js// ç”¨äºåˆå¹¶å¤šä¸ª reducersimport { combineReducers} from â€˜reduxâ€™import car from â€˜./carâ€™ export default combineReducers({ car}) `......å¤ªç—›è‹¦äº†......` ## çŠ¶æ€ç®¡ç† React-redux è‡ªåŠ¨è¿æ¥ - åˆ›å»º reducers - åˆå¹¶ reducers - createStore - Provider store = { store } - connect(mapStateToProps,{...actionCreators})(YourComponent) - actionCreators - ä¿®æ”¹reducers ### é¦–å…ˆåˆ›å»º reducers æ–‡ä»¶ç›®å½•ä¸‹çš„ reduceråˆ†ç±»æ–‡ä»¶ ```js // æœªæ¥é¿å… actionType é‡å¤ï¼Œä¸€èˆ¬ä¼šæŠŠactionæ”¾åœ¨æ–‡ä»¶é‡Œï¼Œç»Ÿä¸€ç®¡ç† import actionType from &#39;../actions/actionType&#39; // å¯¹äº è´­ç‰©è½¦ æ¥è¯´ï¼Œè¿™é‡Œæœ‰ä¸ªåˆå§‹åŒ–çš„çŠ¶æ€ const initState = [ { id: 1, title: &#39;Apple&#39;, price: 999, amount: 10 }, { id: 2, title: &#39;Orange&#39;, price: 99, amount: 6 } ] // åˆ›å»º è´­ç‰©è½¦çš„ reducer ï¼Œæ˜¯ä¸ªçº¯å‡½æ•°ï¼Œreducerçš„å›ºå®šå†™æ³• ä¸¤ä¸ªå‚æ•° // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ stateå¹¶æœ‰ä¸€ä¸ªåˆå§‹å€¼ // ç¬¬äºŒä¸ªå‚æ•°æ˜¯ action export default (state = initState,action) =&gt; { // æ ¹æ®ä¸åŒçš„ action æ¥å¤„ç†ä¸åŒçš„ç»“æœï¼Œæ¯æ¬¡è¿”å›æ–°çš„stateï¼Œè¿”å›çš„ç±»å‹è¦ä¸€æ · switch(action.type){ // ä¸€å®šè¦æœ‰default ï¼Œå½“actionType ä¸å¯¹æ—¶å€™ï¼Œå°±ä¸åšä»»ä½•å¤„ç†ï¼Œè¿”å›ä¸Šä¸€æ¬¡çš„state default: return state; case actionType.CAR_AMOUNT_INCREMENT: return state.map(item =&gt; { if(item.id === action.payload.id){ item.amount += 1 } return item }) case actionType.CAR_AMOUNT_DECREMENT: return state.map(item =&gt; { if(item.id === action.payload.id){ item.amount -= 1 } return item }) } } reducersç›®å½•ä¸‹åˆ›å»º index.js åˆå¹¶å¤šä¸ª reducer å¹¶å¯¼å‡ºç”±äºåœ¨å®é™…ä¸­ï¼Œåªæœ‰å•ä¸€çš„store,ä½†æ˜¯çŠ¶æ€ä¼šæœ‰å¾ˆå¤šåˆ†ç±»ï¼Œå› æ­¤éœ€è¦åˆ’åˆ†reducerï¼Œä½†createStore() å‚æ•°åªæ¥å—ä¸€ä¸ªreducerï¼Œæ‰€ä»¥reduxæä¾›äº†ä¸€ä¸ªåˆå¹¶å¤šä¸ªreducerçš„æ–¹æ³•ï¼šcombineReducers // ç”¨äºåˆå¹¶å¤šä¸ª reducers import { combineReducers} from &#39;redux&#39; // å¼•å…¥ car reducerï¼Œå¦‚æœæœ‰å¤šä¸ªï¼Œç»§ç»­å¼•å…¥ import car from &#39;./car&#39; // å¯¼å‡ºåˆå¹¶åçš„ reducer export default combineReducers({ // æŠŠå¤šä¸ª reducerä½œä¸º combineReducers å‚æ•°å¯¹è±¡ ä¼ å…¥ï¼Œåœ¨å¤–éƒ¨å°±å¯ä»¥é€šè¿‡ store.getState().car æ¥è·å–åˆ° carReduceré‡Œé¢çš„state car }) åˆ›å»º Action ç›®å½•ï¼Œç„¶ååˆ›å»ºç‰¹å®šçš„ car.jsimport actionType from &#39;./actionType&#39; // action æœ‰ä¸¤ç§å†™æ³• // ä¸€ï¼šå†™æˆä¸€ä¸ªå¯¹è±¡ï¼Œç¼ºç‚¹ä¸å¥½ä¼ é€’å‚æ•° // export const increment = { // type: actionType.CAR_AMOUNT_INCREMENT // } // äºŒï¼šå†™æˆä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„action export const increment = (id) =&gt; { return { type: actionType.CAR_AMOUNT_INCREMENT, payload:{ id } } } export const decrement = (id) =&gt; { return { type: actionType.CAR_AMOUNT_DECREMENT, payload:{ id } } } åœ¨Actionç›®å½•ä¸‹åˆ›å»º actionType æ¥ç»Ÿä¸€ç®¡ç† actionexport default { CAR_AMOUNT_INCREMENT: &#39;CAR_AMOUNT_INCREMENT&#39;, CAR_AMOUNT_DECREMENT: &#39;CAR_AMOUNT_DECREMENT&#39;, } åˆ›å»º store.js// createStore æ˜¯ reduxç”¨æ¥åˆ›å»ºstoreçš„æ–¹æ³• import { createStore } from &#39;redux&#39; // å¼•å…¥åˆå¹¶åçš„ reducer import rootReducer from &#39;./reducers&#39; // createStore(rootReducer) ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ ä¸€ä¸ªreducer export default createStore(rootReducer) æœ€åä½¿ç”¨æ”¾åœ¨åº”ç”¨ç¨‹åºæœ€é¡¶å±‚ï¼Œä¸”å¿…é¡»æœ‰ store å±æ€§import React from &#39;react&#39; import {render} from &#39;react-dom&#39; import App from &#39;./App&#39; import store from &#39;./store&#39; // Rrovier æ˜¯ react-redux æä¾›çš„ä¸€ä¸ªç»„ä»¶ import { Provider } from &#39;react-redux&#39; render( // è¿™ä¸ªstore çš„å€¼ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€åˆ›å»ºçš„ store // åªè¦è¢« Producer åŒ…è£¹çš„ç»„ä»¶ï¼Œæ‰€æœ‰çš„åä»£ç»„ä»¶éƒ½å¯ä»¥ä½¿ç”¨Redux.connectåšè¿æ¥ &lt;Provider store={store}&gt; &lt;App /&gt; &lt;/Provider&gt;, document.querySelector(&quot;#root&quot;) ) å­ç»„ä»¶è¿æ¥è·å–æ•°æ®import React, { Component } from &#39;react&#39; // å¯¼å…¥ actionCreators import { increment,decrement } from &#39;../../actions/car&#39; // connect æ‰§è¡Œåæ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ import { connect } from &#39;react-redux&#39; class CarList extends Component { render() { return ( &lt;table&gt; &lt;tbody&gt; { this.props.carList.map(item =&gt; { return ( &lt;tr key={item.id}&gt; &lt;td&gt;{item.id}&lt;/td&gt; &lt;td&gt;{item.title}&lt;/td&gt; &lt;td&gt;{item.price}&lt;/td&gt; &lt;td&gt; &lt;button onClick={()=&gt;{ this.props.dispatch(decrement(item.id)) }}&gt;-&lt;/button&gt; &lt;span&gt;{item.amount}&lt;/span&gt; &lt;button onClick={()=&gt;{ this.props.dispatch(increment(item.id)) }}&gt;+&lt;/button&gt; &lt;/td&gt; &lt;td&gt;&lt;/td&gt; &lt;/tr&gt; ) }) } &lt;/tbody&gt; &lt;/table&gt; ) } } // è¿™é‡Œçš„ state å®é™…ä¸Šå°±æ˜¯ store.getState()çš„å€¼ const mapStateToProps = (state) =&gt; { // è¿™é‡Œreturnäº†ä»€ä¹ˆï¼Œç»„ä»¶ä¸­å°±å¯ä»¥this.propsæ¥è·å– return { carList: state.car } } // connectæ–¹æ³•å¸¸ç”¨çš„å‚æ•° // ç¬¬ä¸€ä¸ªå‚æ•°ï¼š mapStateToProps ä½œç”¨å°±æ˜¯ä»storeé‡ŒæŠŠstateæ³¨å…¥åˆ°å½“å‰ç»„ä»¶props // ç¬¬äºŒä¸ªå‚æ•°ï¼šå¯ä»¥æ˜¯mapDisPatchPropsï¼Œè¿™ä¸ªä¸»è¦ä½œç”¨å°±æ˜¯å°†actionç”Ÿæˆçš„æ–¹æ³•æ³¨å…¥åˆ°å•ç­¾ç»„ä»¶çš„props // ç›´æ¥ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ä¸€ä¸ªå¯¹è±¡ï¼Œé‡Œé¢çš„å¯¹è±¡å°±æ˜¯actionCratorsï¼Œåªè¦ä¼ å…¥äº†ï¼Œåœ¨ç»„ä»¶ä¸­å°±å¯ä»¥é€šè¿‡this.props.actionCreatoræ¥è°ƒç”¨ export default connect(mapStateToProps)(CarList) redux å¤„ç† å¼‚æ­¥æ“ä½œ éœ€è¦ä¸€ä¸ªä¸­é—´ä»¶å¤„ç† npm install redux-thunk å…ˆåœ¨ store ä¸­ä¼ å…¥applyMiddleware(thunk) export default createStore(rootReducer,applyMiddleware(thunk)) ç„¶ååœ¨ actions ä¸­å¯¼å‡ºä»¥ä¸‹ä»£ç  export const decrementAsync = id =&gt; dispatch =&gt; { setTimeout(() =&gt; { dispatch(decrement(id)) }, 1000); } è·¯ç”± React Routerç®€å•åŒ¹é…Web ä¸Šå®‰è£…åªéœ€è¦å®‰è£…è¿™ä¸€ä¸ªå°±å¯ä»¥äº† npm i react-router-dom -s åªéœ€è¦åœ¨æœ€é¡¶å±‚ä½¿ç”¨ä¸€æ¬¡Routerå°±å¯ä»¥äº†Router åªéœ€è¦åœ¨æœ€é¡¶çº§ä½¿ç”¨ä¸€æ¬¡å°±å¯ä»¥äº† import React from &#39;react&#39; import {render} from &#39;react-dom&#39; import App from &#39;./App&#39; // å°† BrowserRouter é‡å‘½åä¸º Router ï¼Œæ–¹ä¾¿è°ƒç”¨ // HashRouter and BrowserRouter å¯ä»¥é€‰æ‹© è·¯ç”±æ¨¡å¼ // Route ç»„ä»¶ç›¸å½“äº Vueä¸­ çš„ &lt;router-view&gt;&lt;/router-view&gt; import { BrowserRouter as Router,Route } from &#39;react-router-dom&#39; render( // æœ€é¡¶å±‚åªéœ€ä½¿ç”¨ Router åŒ…è£¹ä¸€æ¬¡å°±å¯ä»¥äº† &lt;Router&gt; ä½¿ç”¨ Routeç»„ä»¶ æ¥æ¸²æŸ“ç»„ä»¶ &lt;Route component={App}/&gt; &lt;/Router&gt;, document.querySelector(&quot;#root&quot;) ) è·¯ç”±è·³è½¬import React, { Component } from &#39;react&#39; // è·¯ç”±è·³è½¬éœ€è¦ä½¿ç”¨åˆ° Link ç»„ä»¶ï¼Œç›¸å½“äºVueä¸­çš„,&lt;router-link&gt;&lt;/router-link&gt; // NavLink ä½œç”¨å’Œ Link ä½œç”¨å·®ä¸å¤šï¼Œä½† NavLinkå¯ä»¥ç»™é“¾æ¥è‡ªåŠ¨æ·»åŠ ä¸€äº›å±æ€§ // Redirect ç»„ä»¶ è´Ÿè´£ é¡µé¢é‡å®šå‘ import { Route, Link, NavLink, Redirect } from &#39;react-router-dom&#39; import { Home, Artical, Users } from &#39;./views&#39; export default class App extends Component { render() { return ( &lt;div&gt; &lt;ul&gt; &lt;li&gt;&lt;Link to=&quot;/home&quot;&gt;é¦–é¡µ&lt;/Link&gt;&lt;/li&gt; &lt;li&gt;&lt;Link to=&quot;/artical&quot;&gt;æ–‡ç« &lt;/Link&gt;&lt;/li&gt; &lt;li&gt;&lt;NavLink to=&quot;/users&quot;&gt;ç”¨æˆ·&lt;/NavLink&gt;&lt;/li&gt; &lt;/ul&gt; é¡µé¢é‡å®šå‘ &lt;Redirect to=&quot;/home&quot; from=&quot;/&quot;&gt;&lt;/Redirect&gt; &lt;Route component={Home} path=&quot;/home&quot; /&gt; &lt;Route component={Artical} path=&quot;/artical&quot; /&gt; &lt;Route component={Users} path=&quot;/users&quot; /&gt; &lt;/div&gt; ) } } åŠ¨æ€è·¯ç”± ç‚¹å‡»é“¾æ¥åï¼Œé“¾æ¥ä¸æ¶ˆå¤±ï¼Œåœ¨é“¾æ¥çš„é¡µé¢ä¸Šæ”¾ç½® artical.js import React, { Component } from &#39;react&#39; import { Link, Route } from &#39;react-router-dom&#39; import ArticalDetail from &#39;./ArticalDetail&#39; export default class Artical extends Component { render() { return ( &lt;div&gt; &lt;Link to=&quot;/artical/1&quot;&gt;æ–‡ç« ä¸€&lt;/Link&gt; &lt;Link to=&quot;/artical/2&quot;&gt;æ–‡ç« äºŒ&lt;/Link&gt; è¿™é‡Œè®¾ç½® path=&quot;/artical/:id&quot; &lt;Route component={ArticalDetail} path=&quot;/artical/:id&quot; /&gt; &lt;/div&gt; ) } } ç»„ä»¶ä¸­ è·å–å‚æ•°çš„æ–¹æ³• {this.props.match.params.id} ç‚¹å‡»é“¾æ¥åé“¾æ¥æ¶ˆå¤±,å³å°† æ”¾ç½®å€¼ä¸è¿æ¥é¡µé¢åŒçº§çš„é¡µé¢ App.js import React, { Component } from &#39;react&#39; import { Route, Link, NavLink, Redirect } from &#39;react-router-dom&#39; import { Home, Artical, Users, ArticalDetail } from &#39;./views&#39; export default class App extends Component { render() { return ( &lt;div&gt; &lt;ul&gt; &lt;li&gt;&lt;Link to=&quot;/home&quot;&gt;é¦–é¡µ&lt;/Link&gt;&lt;/li&gt; &lt;li&gt;&lt;Link to=&quot;/artical&quot;&gt;æ–‡ç« &lt;/Link&gt;&lt;/li&gt; &lt;li&gt;&lt;NavLink to=&quot;/users&quot;&gt;ç”¨æˆ·&lt;/NavLink&gt;&lt;/li&gt; &lt;/ul&gt; &lt;Redirect to=&quot;/home&quot;&gt;&lt;/Redirect&gt; &lt;Route component={Home} path=&quot;/home&quot; /&gt; æ³¨æ„è¦åŠ ä¸Š exactï¼ˆå®Œå…¨åŒ¹é…ï¼‰ &lt;Route component={Artical} path=&quot;/artical&quot; exact/&gt; &lt;Route component={ArticalDetail} path=&quot;/artical/:id&quot; /&gt; &lt;Route component={Users} path=&quot;/users&quot; /&gt; &lt;/div&gt; ) } } å¤„ç† 404import React, { Component } from &#39;react&#39; import { Route, Link, NavLink, Redirect, Switch } from &#39;react-router-dom&#39; import { Home, Artical, Users, ArticalDetail, NotFound } from &#39;./views&#39; export default class App extends Component { render() { return ( &lt;div&gt; &lt;ul&gt; &lt;li&gt;&lt;Link to=&quot;/home&quot;&gt;é¦–é¡µ&lt;/Link&gt;&lt;/li&gt; &lt;li&gt;&lt;Link to=&quot;/artical&quot;&gt;æ–‡ç« &lt;/Link&gt;&lt;/li&gt; &lt;li&gt;&lt;NavLink to=&quot;/users&quot;&gt;ç”¨æˆ·&lt;/NavLink&gt;&lt;/li&gt; &lt;/ul&gt; æ³¨æ„ éœ€è¦ä½¿ç”¨ Switch åŒ…è£¹ï¼Œä¸ç„¶ç¬¦åˆæ¡ä»¶çš„éƒ½å›å»æ¸²æŸ“ &lt;Switch&gt; &lt;Route component={Home} path=&quot;/home&quot; /&gt; &lt;Route component={Artical} path=&quot;/artical&quot; exact/&gt; &lt;Route component={ArticalDetail} path=&quot;/artical/:id&quot; /&gt; &lt;Route component={Users} path=&quot;/users&quot; /&gt; &lt;Route component={NotFound} path=&quot;/404&quot; /&gt; &lt;Redirect to=&quot;/home&quot; from=&quot;/&quot; exact /&gt; &lt;Redirect to=&quot;/404&quot; /&gt; &lt;/Switch&gt; &lt;/div&gt; ) } } è·¯ç”±å…¶ä»–APIä½¿ç”¨ render(function) ä¿©ä»£æ›¿ component={}ä¼˜ç‚¹ï¼Œå¯ä»¥ä¼ é€’å‚æ•° &lt;Router&gt; ä½¿ç”¨renderä½¿ï¼Œé‡Œé¢è¦æ˜¯ä¸ªå‡½æ•°ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‚æ•°ä¸º è·¯ç”±ä¿¡æ¯ ä½¿ç”¨{...props}å‘ä¸‹åˆå¹¶ä¼ é€’ &lt;Route render={(props)=&gt;&lt;App {...props} x={1}/&gt;} path=&quot;/&quot; /&gt; &lt;/Router&gt;, éšå¼ä¼ å‚ä»£æ›¿urlä¼ å‚å¯ä»¥ç”¨æ¥åŸ‹ç‚¹åˆ†äº« &lt;Link to={{ pathname: 'artical/2', state: { form: 'artical' } }}&gt;æ–‡ç« äºŒ&lt;/Link&gt; åŸ‹ç‚¹å‘é€æ•°æ®æ–¹æ³• ajax img: å…¼å®¹æ€§æœ€å¥½ const img = new Image() img.src = &quot;http://...../button-01.gif?x=16....&quot; sendBeacon å…¼å®¹æ€§ä¸å¥½ï¼ŒæˆåŠŸç‡æœ€é«˜ ç¼–ç¨‹å¼å¯¼èˆª history.push(â€˜â€¦â€™) export default class ArticalDetail extends Component { goHome = () =&gt; { this.props.history.push(&#39;/&#39;) } render() { console.log(this.props) return ( &lt;div&gt; æ–‡ç« è¯¦æƒ… {this.props.match.params.id} &lt;button onClick={this.goHome}&gt;è¿”å›é¦–é¡µ&lt;/button&gt; &lt;/div&gt; ) } } this.props.history.push({å¯¹è±¡}) goHome = () =&gt; { this.props.history.push({ pathname: &#39;/&#39;, state: { x: 1 } }) } render() { console.log(this.props) return ( &lt;div&gt; æ–‡ç« è¯¦æƒ… {this.props.match.params.id} &lt;button onClick={this.goHome}&gt;è¿”å›é¦–é¡µ&lt;/button&gt; &lt;/div&gt; ) } withRouter é«˜é˜¶ç»„ä»¶è‹¥æƒ³è¦ç‚¹å‡»ä¸€ä¸ªç»„ä»¶ï¼Œè§¦å‘ç»„ä»¶å†…çš„äº‹ä»¶å¹¶ä½¿ç”¨å½“å‰çš„å‚æ•°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ withRouter é«˜é˜¶ç»„ä»¶åŒ…è£¹ ç»„ä»¶ export default withRouter(BackHome) Antd èš‚èšè®¾è®¡ UIåº“ npm i antd -s é…ç½® Antdcreate-react-appé…ç½® npm i react-app-rewired customize-cra -D ç„¶åä¿®æ”¹ page.json ç„¶ååœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ª config-overrides.js ç”¨äºä¿®æ”¹é»˜è®¤é…ç½®ã€‚ npm i babel-plugin-import -Dä½¿ç”¨ babel-plugin-importåä¿®æ”¹ config-overrides.js ä½¿ç”¨Antdè‡ªå®šä¹‰ä¸»é¢˜éœ€è¦å…ˆå®‰è£… less less-loader å› ä¸º Antd æ ·å¼æ–‡ä»¶ä½¿ç”¨lesså¼€å‘ npm i less less-loader -s const { override, fixBabelImports, addDecoratorsLegacy, addLessLoader } = require(&quot;customize-cra&quot;); module.exports = override( fixBabelImports(&quot;import&quot;, { //antdæŒ‰éœ€åŠ è½½ libraryName: &quot;antd&quot;, libraryDirectory: &quot;es&quot;, style: &quot;css&quot;, style: true }), addDecoratorsLegacy(), // é…ç½®è£…é¥°å™¨ addLessLoader({ // Antd è‡ªå®šä¹‰ä¸»é¢˜è®¾ç½® javascriptEnabled: true, modifyVars: { &#39;@primary-color&#39;: &#39;#1DA57A&#39; }, }), );","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"http://blog.hjiya.cn/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"http://blog.hjiya.cn/categories/æŠ€æœ¯/"}]},{"title":"é¢è¯•é¢˜æ€è€ƒæ±‡æ€»ï¼ˆNodeç¯‡ï¼‰","slug":"interview1","date":"2020-03-21T05:23:03.000Z","updated":"2020-03-26T04:01:34.590Z","comments":true,"path":"2020/03/21/interview1/","link":"","permalink":"http://blog.hjiya.cn/2020/03/21/interview1/","excerpt":"","text":"1. nodeæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹Nodeæ˜¯å•çº¿ç¨‹çš„ï¼Œä½†Nodeèƒ½å¼€å¯å¤šè¿›ç¨‹ 2. é‚£Nodeæ€ä¹ˆå¼€å¯å¤šçº¿ç¨‹å¯ä»¥ä½¿ç”¨Nodeé‡Œçš„å†…ç½®æ¨¡å— Cluster å¼€å¯å¤šè¿›ç¨‹ ä¸‹é¢æ¥çœ‹æ®µä»£ç  const cluster = require(&#39;cluster&#39;) const os = require(&#39;os&#39;) const numCPUs = os.cpus().length const process = require(&#39;process&#39;) console.log(&#39;numCPUs&#39;,numCPUs) const workers = {} if(cluster.isMaster){ cluster.on(&#39;death&#39;, function(worker){ worker = cluster.fork() workers[worker.pid] = worker }) // ä¸»è¿›ç¨‹ for(let i=0;i&lt;numCPUs;i++){ const worker = cluster.fork() workers[worker.pid] = worker } // å½“è¿›ç¨‹è¢«ç»ˆæ­¢ process.on(&#39;SIGTERM&#39;, function(){ for(let pid in workers){ process.kill(pid) } process.exit(0) }) } else { // å…¶ä»–è¿›ç¨‹ï¼Œå·¥ä½œè¿›ç¨‹ const app = require(&#39;./app&#39;) app.use(async (ctx,next) =&gt; { console.log(&#39;worker&#39; + cluster.worker.id + &#39;,PID: &#39; + process.pid) next() }) app.listen(3000,() =&gt; { console.log(&#39;http://127.0.0.1:3000&#39;) }) } 3. è¿™é‡Œéƒ½æ˜¯ç›‘å¬äº†ç»Ÿä¸€ç«¯å£ï¼Œä»–ä»¬ä¼šå†²çªå—ï¼Ÿ å¹¶ä¸ä¼šå†²çªï¼Œç®€å•çš„è¯´ åœ¨æœåŠ¡å™¨åŒæ—¶å¯åŠ¨å¤šä¸ªè¿›ç¨‹ã€‚ æ¯ä¸ªè¿›ç¨‹éƒ½è·‘çš„æ˜¯åŒä¸€ä»½æºç ï¼ˆå¥½æ¯”æŠŠä»¥å‰ä¸€ä¸ªè¿›ç¨‹çš„å·¥ä½œåˆ†ç»™å¤šä¸ªè¿›ç¨‹å»åšï¼‰ æ›´ç¥å¥‡çš„æ˜¯ï¼Œè¿™äº›è¿›ç¨‹å¯ä»¥åŒæ—¶ç›‘å¬ä¸€ä¸ªç«¯å£ å…¶ä¸­ å¯åŠ¨å…¶ä»–è¿›ç¨‹çš„å«åšMasterè¿›ç¨‹ï¼Œä»–å¥½æ¯”æ˜¯ä¸ªåŒ…å·¥å¤´ï¼Œä¸åšå…·ä½“çš„å·¥ä½œï¼Œåªè´Ÿè´£å¯åŠ¨å…¶ä»–è¿›ç¨‹ å…¶ä»–è¢«Masterå¯åŠ¨çš„å«åšWorkerè¿›ç¨‹ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å¹²æ´»çš„å·¥äººï¼Œå®ƒä»¬æ¥å—è¯·æ±‚ï¼Œå¯¹å¤–æä¾›æœåŠ¡ Wokerè¿›ç¨‹æ•°é‡ä¸€èˆ¬å·¥å…·æœåŠ¡å™¨çš„CPUå†³å®šï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨å¤šæ ¸èµ„æº 4. é‚£å®ƒä»¬æ˜¯æ€ä¹ˆè°ƒåº¦çš„æœªå®Œå¾…ç»­â€¦","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"http://blog.hjiya.cn/categories/æŠ€æœ¯/"}],"tags":[],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"http://blog.hjiya.cn/categories/æŠ€æœ¯/"}]},{"title":"Birthday","slug":"birthday","date":"2020-03-21T02:47:04.000Z","updated":"2020-03-21T04:19:58.633Z","comments":true,"path":"2020/03/21/birthday/","link":"","permalink":"http://blog.hjiya.cn/2020/03/21/birthday/","excerpt":"","text":"å‰è¨€é—²æ¥æ— äº‹ï¼Œæ­ä¸ªåšå®¢å§ï¼Œä¹Ÿä¸çŸ¥é“å†™äº›å•¥ï¼Œé‚£å°±è®°å½•ä¸‹æˆ‘é‚£å¹³æ·¡æ— å¥‡çš„ç”Ÿæ´»å§ã€‚","categories":[{"name":"éšæƒ³","slug":"éšæƒ³","permalink":"http://blog.hjiya.cn/categories/éšæƒ³/"}],"tags":[{"name":"æ‚¦è¯»","slug":"æ‚¦è¯»","permalink":"http://blog.hjiya.cn/tags/æ‚¦è¯»/"}],"keywords":[{"name":"éšæƒ³","slug":"éšæƒ³","permalink":"http://blog.hjiya.cn/categories/éšæƒ³/"}]}]}